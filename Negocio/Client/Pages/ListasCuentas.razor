@page "/cuenta"

@inject IHttpServicio http

<PageTitle>CUENTAS</PageTitle>

<HeadContent>
    <meta name="description" content="Listado de Cuentas" />
</HeadContent>

<h3>Lista de Cuentas</h3>

<table class="table">
    <thead>
        <tr>
            <th>Nuemero de cuenta</th>
            <th>Saldo Total</th>
            <th>Cuotas</th>
        
        </tr>
    </thead>

    <tbody>
        @if (Error)
        {
            <tr>@Mensaje</tr>
        }
        else
        {
            @if (cuentas == null)
            {
                <tr>Cargando....</tr>
            }
            else if (cuentas.Count == 0)
            {
                <tr>no existen datos</tr>
            }
            else
            {
                @foreach (var item in cuentas)
                {
                    <tr>
                        <td>@item.NumeroCuenta</td>
                        <td>@item.SaldoTotal</td>
                        <td>@item.Cuotas</td>
                      
                    </tr>
                }
            }
        }
    </tbody>

</table>

@code {


    List<Cuenta>? cuentas;
    bool Error = false;
    string Mensaje = "";

    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        await Leer();
    }

    private async Task Leer()
    {
        var respuesta = await http.Get<List<Cuenta>>("api/cuenta");
        Error = respuesta.Error;
        if (!respuesta.Error)
        {
            cuentas = respuesta.Respuesta;
        }
        else
        {
            Mensaje = await respuesta.ObtenerError();
        }
    }

}
